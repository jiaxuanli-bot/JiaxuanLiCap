
<div id="main" *ngIf="year">
  <!-- top nav -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">Faculty</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbar">
      <ul class="navbar-nav mr-auto">
      </ul>
      <ul class="navbar-nav ml-auto mr-3">
        <div ngbDropdown class="d-inline-block">
          <button class="btn btn-outline-primary" id="dropdownMenuButton" ngbDropdownToggle>{{authentication.currentUserValue.first}} {{authentication.currentUserValue.last}}</button>
          <div ngbDropdownMenu aria-labelledby="dropdownMenuButton">
            <button ngbDropdownItem (click)="authentication.logout()">Logout</button>
          </div>
        </div>
      </ul>
    </div>
  </nav>

  <div class="table-responsive">
    <form [formGroup]="facultiesForm">
    <table class="table table-bordered table-striped col-xs-12 col-md-12 col-lg-12" id="facultyTable">
      <thead>
      <tr id="searchTr">
          <th>
            <input type="text" class="form-control searchInput" formControlName="first" aria-describedby="basic-addon1" (ngModelChange)="changed($event)">
          </th>
          <th>
            <input type="text" class="form-control searchInput" formControlName="last" aria-describedby="basic-addon1" (ngModelChange)="changed($event)">
          </th>

          <th *ngFor="let controlName of ['rank', 'college', 'tenured', 'soe', 'admin', 'gender']">
            <select [formControlName]="controlName" class= "form-control" (ngModelChange)="changed($event)">
              <option *ngFor="let opt of options[controlName]">{{opt}}</option>
            </select>
          </th>

          <th>
            <div class="btn btn-primary btn-sm" (click)="clear()">
              Clear
            </div>
          </th>
      </tr>
      <tr>
        <th *ngFor="let property of ['First','Last','Rank','College','Tenured','SOE','Admin','Gender','Dept','Chair','Action']">
          {{property}}
        </th>
      </tr>
      </thead>
      <tbody>

      <tr *ngFor="let faculty of faculties; index as i;" id="firstLine">
        <ng-container *ngIf="i!==editIndex">
          <td>
            {{faculty.first}}
          </td>
          <td>
            {{faculty.last}}
          </td>
          <td>
            {{faculty.rank}}
          </td>
          <td>
            {{faculty.college.college}}
          </td>
          <td>
            <label class="myCheckBox">
              <input type="checkbox" checked="checked">
              <span [ngClass]="faculty.tenured?'checkmark':'emptyCheckBox'"></span>
            </label>
          </td>
          <td>
            <label class="myCheckBox">
              <input type="checkbox" checked="checked">
              <span [ngClass]="faculty.soe?'checkmark':'emptyCheckBox'"></span>
            </label>
          </td>
          <td>
            <label class="myCheckBox">
              <input type="checkbox" checked="checked">
              <span [ngClass]="faculty.adminResponsibility?'checkmark':'emptyCheckBox'"></span>
            </label>
          </td>
          <td class="text-center">
            {{faculty.gender.gender}}
          </td>
          <td class="text-center">
            {{faculty.dept.deptName}}
          </td>
          <td>
            <label class="myCheckBox">
              <input type="checkbox" checked="checked">
              <span [ngClass]="faculty.chair?'checkmark':'emptyCheckBox'"></span>
            </label>
          </td>

          <td>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2 view-link file-trash-icon" href="#" data-toggle="modal" data-target="#exampleModal" (click)="delete(i)"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-3 view-link file-edit-icon" href="#" (click)="edit(i)"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text view-link file-text-icon" data-toggle="modal" data-target="#committeeListModal"  (click)="getUserCommittees(i)" href="#"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
          </td>
        </ng-container>
        <ng-container *ngIf="i==editIndex">
          <td>
            <input type="text" formControlName="editFirst">
          </td>
          <td>
            <input type="text" formControlName="editLast">
          </td>
          <td>
            <select class="form-control" formControlName="editRank">
              <option *ngFor="let rank of ranks">{{rank}}</option>
            </select>
          </td>
          <td>
            <select class="form-control" formControlName="editCollege">
              <option *ngFor="let college of colleges">{{college}}</option>
            </select>
          </td>
          <td>
            <input  formControlName="editTenured" type="checkbox" class="check" [checked]="faculties[i].tenured">
          </td>
          <td>
            <input type="checkbox" class="check" formControlName="editSoe" [checked]="faculties[i].soe">
          </td>
          <td>
            <input type="checkbox" formControlName="editAdmin" class="check" [checked]="faculties[i].adminResponsibility">
          </td>
          <td>
            <select class="form-control" formControlName="editGender">
              <option *ngFor="let gender of genders">{{gender}}</option>
            </select>
          </td>
          <td>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check file-check-icon" data-target="#modifyModal" data-toggle="modal"><polyline points="20 6 9 17 4 12"></polyline></svg>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x file-x-icon" data-target="#cancelModal" data-toggle="modal"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
          </td>
        </ng-container>
      </tr>
      </tbody>
    </table>
    </form>
  </div>

  <div class="table-buttons mt-4" id="tableFooterGroup">
    <ul class="pagination">
      <ng-container *ngIf="faculties&&faculties.length>0">
        <li [ngClass]="page.first?['page-item', 'disabledPagation']:['page-item']" (click)="firstPage()">
          <a [ngClass]="page.first?['page-link', 'disabledPagation']:['page-link']" aria-label="Previous">
            <span aria-hidden="true">|<</span>
          </a>
        </li>

        <li [ngClass] = "page.first?['page-item', 'disabledPagation']:['page-item']" (click)="prevoiusPage()">
          <a [ngClass] = "page.first?['page-link', 'disabledPagation']:['page-link']" aria-label="Previous">
            <span aria-hidden="true"><</span>
          </a>
        </li>

        <ng-container *ngFor="let i of [].constructor(page.totalPages);index as j;">
          <li *ngIf="page.number !== j " class="page-item" (click)="gotoPage(j)"><a class="page-link">{{j+1}}</a></li>
          <li *ngIf="page.number === j " class="page-item selectedpageItem" (click)="gotoPage(j)"><a class="page-link selectPage">{{j+1}}</a></li>
        </ng-container>

        <li [ngClass]="page.last?['page-item', 'disabledPagation']:['page-item']" (click)="nextPage()">
          <a [ngClass]="page.last?['page-link', 'disabledPagation']:['page-link']" aria-label="Next">
            <span aria-hidden="true">></span>
          </a>
        </li>
        <li [ngClass]="page.last?['page-item', 'disabledPagation']:['page-item']" (click)="lastPage()">
          <a [ngClass]="page.last?['page-link', 'disabledPagation']:['page-link']" aria-label="Next">
            <span aria-hidden="true">>|</span>
          </a>
        </li>
      </ng-container>
      <ul class="mr-auto">
      </ul>

      <button type="button" class="btn btn-primary mb-5 mr-3" data-toggle="modal" data-target="#addUsersModal">
        <i class="user-plus-icon ml-2 mr-1" data-feather="user-plus"></i>Upload Faculties From CSV File
      </button>

      <button type="button" class="btn btn-primary mb-5" data-toggle="modal" data-target="#userModal">
        <i class="user-plus-icon ml-2 mr-1" data-feather="user-plus"></i>Add Faculty
      </button>
    </ul>
  </div>

  <!-- Modal for delete-->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <app-delete-user (deleteUser)="deleteUser()"></app-delete-user>
  </div>

  <!-- Modal for modify-->
  <div class="modal fade" id="modifyModal" tabindex="-1" role="dialog" aria-labelledby="modifyModalLabel" aria-hidden="true">
    <app-modify-user (modifyUser) = "modifyUser()"></app-modify-user>
  </div>

  <!-- Modal for add user-->
  <div class="modal fade" id="userModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <app-add-user (addUser) = "this.gotoPage(this.page.number);"></app-add-user>
  </div>

  <!-- Modal add users from csv-->
  <div class="modal fade" id="addUsersModal" tabindex="-1" role="dialog" aria-labelledby="modifyModalLabel" aria-hidden="true">
    <app-add-user-from-csv (addUserFromCSV) = "this.gotoPage(this.page.number);"></app-add-user-from-csv>
  </div>

  <!-- Modal for cancel modify user-->
  <div class="modal fade" id="cancelModal" tabindex="-1" role="dialog" aria-labelledby="modifyModalLabel" aria-hidden="true">
    <app-cancel-modify [(editIndex)]="editIndex"></app-cancel-modify>
  </div>

  <div class="modal fade" id="committeeListModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span class="closeBtn mr-4" aria-hidden="true">&times;</span>
          </button>
          <div>
            <h3 class="featuredHead">Committees List</h3>
            <ul class="nav nav-tabs mb-4" role="tablist">
              <li role="presentation" class="active">
              </li>
            </ul>
            <div class="mb-3 mt-4">
              <div id="h1">
                <div class="input-group mb-2">
                  Assigned Committees
                </div>
              </div>
              <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active">
                </li>
              </ul>
              <div class="table-responsive ">
                <table class="table table-bordered table-striped col-xs-12 col-md-12 col-lg-12">
                  <tbody class="committeeListClickable">
                  <tr *ngFor = "let committee of userAssignedCommittees;index as i" data-dismiss="modal">
                    <td [routerLink]="['/committees', committee.id]">
                      {{committee.name}}
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="mb-3" >
              <div id="h2">
                <div class="input-group mb-2 mt-4">
                  Volunteered Committees
                </div>
              </div>
              <ul class="nav nav-tabs mb-2" role="tablist">
                <li role="presentation" class="active">
                </li>
              </ul>
              <div class="table-responsive">
                <table class="table table-bordered table-striped col-xs-12 col-md-12 col-lg-12">
                  <tbody class="committeeListClickable">

                  <tr *ngFor = "let committee of userVolunteeredCommittees;index as i" data-dismiss="modal">
                    <td [routerLink]="['/committees', committee.id]">
                      {{committee.name}}
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container" id="footerText">
      <span class="text-dark">UWLAX</span>
    </div>
  </footer>
</div>
